<html>
    <head>
        <title>TEST</title>
        <script type="text/javascript">
            
            function sendMessage(obj) {
                if ( websocket != null )
                {
                    var json = JSON.stringify(obj);
                    websocket.send( json );
                    console.log("json sent:", json);
                }
            }

            function receiveMessage(json) {
                console.log("received json", json);
            }

            var wsUri = "ws://localhost:1234";
            var websocket = null;

            function initWebSocket() {
                try {
                    if (typeof MozWebSocket == 'function')
                        WebSocket = MozWebSocket;
                    if ( websocket && websocket.readyState == 1 )
                        websocket.close();
                    websocket = new WebSocket( wsUri );
                    websocket.onopen = function (evt) {
                        console.log("socket opened");
                    };
                    websocket.onclose = function (evt) {
                        console.log("socket closed")
                    };
                    websocket.onmessage = function (evt) {
                        console.log("json received :", evt.data);
                        receiveMessage(evt.data);
                    };
                    websocket.onerror = function (evt) {
                        console.log("socket error:", evt)
                    };
                } catch (exception) {
                    console.log('EXCEPTION: ' + exception);
                }
            }

            function stopWebSocket() {
                if (websocket) {
                    websocket.close();
                }
            }

            window.onload = initWebSocket;
            window.onclose = stopWebSocket;

            function buttonClick() {
                sendMessage({ event: "button-click", type: "button", id: event.target.id });
            }

            function valueChanged() {
                sendMessage({ event: "value-changed", type: event.target.type, id: event.target.id, value: event.target.value });
            }

            function checkChanged() {
                sendMessage({ event: "check-changed", type: event.target.type, id: event.target.id, checked: event.target.checked });
            }
           
        </script>
    </head>
    <body>
        <div>
            <button id="button-1" onclick="buttonClick()">Button 1</button>
            <br>
            <button id="button-2" onclick="buttonClick()">Button 2</button>
            <br>
            <input type="number" id="number" value="5" onchange="valueChanged()"/>
            <br>
            <input type="text" id="text" value="hello" onchange="valueChanged()"/>
            <br>
            <input type="checkbox" id="checkbox" onchange="checkChanged()"/>
            <br>
            <input type="radio" name="radio" id="radio-1" checked onchange="checkChanged()"/>
            <br>
            <input type="radio" name="radio" id="radio-2" onchange="checkChanged()"/>
            <br>
            <select id="select" onchange="valueChanged()">
                <option value="one">One</option>
                <option value="two">Two</option>
            </select>
        </div>
    </body>
</html>